<HTML><HEAD><META CONTENT="text/html; charset=ISO-8859-1" HTTP-EQUIV="Content-Type"/><TITLE>EMMA Coverage Report</TITLE><STYLE TYPE="text/css"> TABLE,TD,TH {border-style:solid; border-color:black;} TD,TH {background:white;margin:0;line-height:100%;padding-left:0.5em;padding-right:0.5em;} TD {border-width:0 1px 0 0;} TH {border-width:1px 1px 1px 0;} TR TD.h {color:red;} TABLE {border-spacing:0; border-collapse:collapse;border-width:0 0 1px 1px;} P,H1,H2,H3,TH {font-family:verdana,arial,sans-serif;font-size:10pt;} TD {font-family:courier,monospace;font-size:10pt;} TABLE.hdft {border-spacing:0;border-collapse:collapse;border-style:none;} TABLE.hdft TH,TABLE.hdft TD {border-style:none;line-height:normal;} TABLE.hdft TH.tl,TABLE.hdft TD.tl {background:#6699CC;color:white;} TABLE.hdft TD.nv {background:#6633DD;color:white;} .nv A:link {color:white;} .nv A:visited {color:white;} .nv A:active {color:yellow;} TABLE.hdft A:link {color:white;} TABLE.hdft A:visited {color:white;} TABLE.hdft A:active {color:yellow;} .in {color:#356085;} TABLE.s TD {padding-left:0.25em;padding-right:0.25em;} TABLE.s TD.l {padding-left:0.25em;padding-right:0.25em;text-align:right;background:#F0F0F0;} TABLE.s TR.z TD {background:#FF9999;} TABLE.s TR.p TD {background:#FFFF88;} TABLE.s TR.c TD {background:#CCFFCC;} A:link {color:#0000EE;text-decoration:none;} A:visited {color:#0000EE;text-decoration:none;} A:hover {color:#0000EE;text-decoration:underline;} TABLE.cn {border-width:0 0 1px 0;} TABLE.s {border-width:1px 0 1px 1px;} TD.h {color:red;border-width:0 1px 0 0;} TD.f {border-width:0 1px 0 1px;} TD.hf {color:red;border-width:0 1px 0 1px;} TH.f {border-width:1px 1px 1px 1px;} TR.cis TD {background:#F0F0F0;} TR.cis TD {border-width:1px 1px 1px 0;} TR.cis TD.h {color:red;border-width:1px 1px 1px 0;} TR.cis TD.f {border-width:1px 1px 1px 1px;} TR.cis TD.hf {color:red;border-width:1px 1px 1px 1px;} TD.b {border-style:none;background:transparent;line-height:50%;}  TD.bt {border-width:1px 0 0 0;background:transparent;line-height:50%;} TR.o TD {background:#F0F0F0;}TABLE.it {border-style:none;}TABLE.it TD,TABLE.it TH {border-style:none;}</STYLE></HEAD><BODY><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="tl"><A HREF="http://emma.sourceforge.net/">EMMA</A> Coverage Report (generated Tue Nov 08 17:03:51 GMT 2011)</TH></TR><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="1f.html">jmt.engine.math</A>]</TD></TR></TABLE><H2>COVERAGE SUMMARY FOR SOURCE FILE [<SPAN CLASS="in">Arithmetic.java</SPAN>]</H2><TABLE CELLSPACING="0" WIDTH="100%"><TR><TH>name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD>Arithmetic.java</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/17)</TD><TD CLASS="h">0%   (0/1408)</TD><TD CLASS="h">0%   (0/109)</TD></TR></TABLE><H3>COVERAGE BREAKDOWN BY CLASS AND METHOD</H3><TABLE CLASS="cn" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="f">name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#0">Arithmetic</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/17)</TD><TD CLASS="h">0%   (0/1408)</TD><TD CLASS="h">0%   (0/109)</TD></TR><TR><TD CLASS="f"><A HREF="#0">&lt;static initializer&gt;</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/941)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2">Arithmetic (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#3">binomial (double, long): double</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/56)</TD><TD CLASS="h">0%   (0/12)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4">binomial (long, long): double</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/119)</TD><TD CLASS="h">0%   (0/23)</TD></TR><TR><TD CLASS="f"><A HREF="#5">ceil (double): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6">chbevl (double, double [], int): double</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/37)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="f"><A HREF="#7">fac1 (int): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/42)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8">fac2 (int): double</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/32)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="f"><A HREF="#9">factorial (int): double</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/33)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a">floor (double): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#b">log (double, double): double</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c">log10 (double): double</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#d">log2 (double): double</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e">logFactorial (int): double</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/56)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR><TD CLASS="f"><A HREF="#f">longFactorial (int): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/20)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#10">stirlingCorrection (int): double</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/40)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="f"><A HREF="#11">xlongBinomial (long, long): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR></TABLE><P></P><TABLE CLASS="s" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="l">1</TD><TD>/*</TD></TR><TR><TD CLASS="l">2</TD><TD>Copyright © 1999 CERN - European Organization for Nuclear Research.</TD></TR><TR><TD CLASS="l">3</TD><TD>Permission to use, copy, modify, distribute and sell this software and its documentation for any purpose</TD></TR><TR><TD CLASS="l">4</TD><TD>is hereby granted without fee, provided that the above copyright notice appear in all copies and</TD></TR><TR><TD CLASS="l">5</TD><TD>that both that copyright notice and this permission notice appear in supporting documentation.</TD></TR><TR><TD CLASS="l">6</TD><TD>CERN makes no representations about the suitability of this software for any purpose.</TD></TR><TR><TD CLASS="l">7</TD><TD>It is provided &#34;as is&#34; without expressed or implied warranty.</TD></TR><TR><TD CLASS="l">8</TD><TD>*/</TD></TR><TR><TD CLASS="l">9</TD><TD>package jmt.engine.math;</TD></TR><TR><TD CLASS="l">10</TD><TD> </TD></TR><TR><TD CLASS="l">11</TD><TD>/**</TD></TR><TR><TD CLASS="l"><A NAME="0">12</A></TD><TD> * Arithmetic functions.</TD></TR><TR><TD CLASS="l">13</TD><TD> */</TD></TR><TR><TD CLASS="l">14</TD><TD>public class Arithmetic extends Constants {</TD></TR><TR><TD CLASS="l">15</TD><TD>        // for method stirlingCorrection(...)</TD></TR><TR CLASS="z"><TD CLASS="l">16</TD><TD>        private static final double[] stirlingCorrection = { 0.0, 8.106146679532726e-02, 4.134069595540929e-02, 2.767792568499834e-02,</TD></TR><TR><TD CLASS="l">17</TD><TD>                        2.079067210376509e-02, 1.664469118982119e-02, 1.387612882307075e-02, 1.189670994589177e-02, 1.041126526197209e-02, 9.255462182712733e-03,</TD></TR><TR><TD CLASS="l">18</TD><TD>                        8.330563433362871e-03, 7.573675487951841e-03, 6.942840107209530e-03, 6.408994188004207e-03, 5.951370112758848e-03, 5.554733551962801e-03,</TD></TR><TR><TD CLASS="l">19</TD><TD>                        5.207655919609640e-03, 4.901395948434738e-03, 4.629153749334029e-03, 4.385560249232324e-03, 4.166319691996922e-03, 3.967954218640860e-03,</TD></TR><TR><TD CLASS="l">20</TD><TD>                        3.787618068444430e-03, 3.622960224683090e-03, 3.472021382978770e-03, 3.333155636728090e-03, 3.204970228055040e-03, 3.086278682608780e-03,</TD></TR><TR><TD CLASS="l">21</TD><TD>                        2.976063983550410e-03, 2.873449362352470e-03, 2.777674929752690e-03, };</TD></TR><TR><TD CLASS="l">22</TD><TD> </TD></TR><TR><TD CLASS="l">23</TD><TD>        // for method logFactorial(...)</TD></TR><TR><TD CLASS="l">24</TD><TD>        // getLog(k!) for k = 0, ..., 29</TD></TR><TR CLASS="z"><TD CLASS="l">25</TD><TD>        protected static final double[] logFactorials = { 0.00000000000000000, 0.00000000000000000, 0.69314718055994531, 1.79175946922805500,</TD></TR><TR><TD CLASS="l">26</TD><TD>                        3.17805383034794562, 4.78749174278204599, 6.57925121201010100, 8.52516136106541430, 10.60460290274525023, 12.80182748008146961,</TD></TR><TR><TD CLASS="l">27</TD><TD>                        15.10441257307551530, 17.50230784587388584, 19.98721449566188615, 22.55216385312342289, 25.19122118273868150, 27.89927138384089157,</TD></TR><TR><TD CLASS="l">28</TD><TD>                        30.67186010608067280, 33.50507345013688888, 36.39544520803305358, 39.33988418719949404, 42.33561646075348503, 45.38013889847690803,</TD></TR><TR><TD CLASS="l">29</TD><TD>                        48.47118135183522388, 51.60667556776437357, 54.78472939811231919, 58.00360522298051994, 61.26170176100200198, 64.55753862700633106,</TD></TR><TR><TD CLASS="l">30</TD><TD>                        67.88974313718153498, 71.25703896716800901 };</TD></TR><TR><TD CLASS="l">31</TD><TD> </TD></TR><TR><TD CLASS="l">32</TD><TD>        // k! for k = 0, ..., 20</TD></TR><TR CLASS="z"><TD CLASS="l">33</TD><TD>        protected static final long[] longFactorials = { 1L, 1L, 2L, 6L, 24L, 120L, 720L, 5040L, 40320L, 362880L, 3628800L, 39916800L, 479001600L,</TD></TR><TR><TD CLASS="l">34</TD><TD>                        6227020800L, 87178291200L, 1307674368000L, 20922789888000L, 355687428096000L, 6402373705728000L, 121645100408832000L,</TD></TR><TR><TD CLASS="l">35</TD><TD>                        2432902008176640000L };</TD></TR><TR><TD CLASS="l">36</TD><TD> </TD></TR><TR><TD CLASS="l">37</TD><TD>        // k! for k = 21, ..., 170</TD></TR><TR CLASS="z"><TD CLASS="l">38</TD><TD>        protected static final double[] doubleFactorials = { 5.109094217170944E19, 1.1240007277776077E21, 2.585201673888498E22, 6.204484017332394E23,</TD></TR><TR><TD CLASS="l">39</TD><TD>                        1.5511210043330984E25, 4.032914611266057E26, 1.0888869450418352E28, 3.048883446117138E29, 8.841761993739701E30, 2.652528598121911E32,</TD></TR><TR><TD CLASS="l">40</TD><TD>                        8.222838654177924E33, 2.6313083693369355E35, 8.68331761881189E36, 2.952327990396041E38, 1.0333147966386144E40, 3.719933267899013E41,</TD></TR><TR><TD CLASS="l">41</TD><TD>                        1.3763753091226346E43, 5.23022617466601E44, 2.0397882081197447E46, 8.15915283247898E47, 3.34525266131638E49, 1.4050061177528801E51,</TD></TR><TR><TD CLASS="l">42</TD><TD>                        6.041526306337384E52, 2.6582715747884495E54, 1.196222208654802E56, 5.502622159812089E57, 2.5862324151116827E59, 1.2413915592536068E61,</TD></TR><TR><TD CLASS="l">43</TD><TD>                        6.082818640342679E62, 3.0414093201713376E64, 1.5511187532873816E66, 8.06581751709439E67, 4.274883284060024E69, 2.308436973392413E71,</TD></TR><TR><TD CLASS="l">44</TD><TD>                        1.2696403353658264E73, 7.109985878048632E74, 4.052691950487723E76, 2.350561331282879E78, 1.386831185456898E80, 8.32098711274139E81,</TD></TR><TR><TD CLASS="l">45</TD><TD>                        5.075802138772246E83, 3.146997326038794E85, 1.9826083154044396E87, 1.2688693218588414E89, 8.247650592082472E90, 5.443449390774432E92,</TD></TR><TR><TD CLASS="l">46</TD><TD>                        3.6471110918188705E94, 2.48003554243683E96, 1.7112245242814127E98, 1.1978571669969892E100, 8.504785885678624E101, 6.123445837688612E103,</TD></TR><TR><TD CLASS="l">47</TD><TD>                        4.470115461512686E105, 3.307885441519387E107, 2.4809140811395404E109, 1.8854947016660506E111, 1.451830920282859E113,</TD></TR><TR><TD CLASS="l">48</TD><TD>                        1.1324281178206295E115, 8.94618213078298E116, 7.15694570462638E118, 5.797126020747369E120, 4.7536433370128435E122, 3.94552396972066E124,</TD></TR><TR><TD CLASS="l">49</TD><TD>                        3.314240134565354E126, 2.8171041143805494E128, 2.4227095383672744E130, 2.107757298379527E132, 1.854826422573984E134,</TD></TR><TR><TD CLASS="l">50</TD><TD>                        1.6507955160908465E136, 1.4857159644817605E138, 1.3520015276784033E140, 1.2438414054641305E142, 1.156772507081641E144,</TD></TR><TR><TD CLASS="l">51</TD><TD>                        1.0873661566567426E146, 1.0329978488239061E148, 9.916779348709491E149, 9.619275968248216E151, 9.426890448883248E153,</TD></TR><TR><TD CLASS="l">52</TD><TD>                        9.332621544394415E155, 9.332621544394418E157, 9.42594775983836E159, 9.614466715035125E161, 9.902900716486178E163, 1.0299016745145631E166,</TD></TR><TR><TD CLASS="l">53</TD><TD>                        1.0813967582402912E168, 1.1462805637347086E170, 1.2265202031961373E172, 1.324641819451829E174, 1.4438595832024942E176,</TD></TR><TR><TD CLASS="l">54</TD><TD>                        1.5882455415227423E178, 1.7629525510902457E180, 1.974506857221075E182, 2.2311927486598138E184, 2.543559733472186E186,</TD></TR><TR><TD CLASS="l">55</TD><TD>                        2.925093693493014E188, 3.393108684451899E190, 3.96993716080872E192, 4.6845258497542896E194, 5.574585761207606E196, 6.689502913449135E198,</TD></TR><TR><TD CLASS="l">56</TD><TD>                        8.094298525273444E200, 9.875044200833601E202, 1.2146304367025332E205, 1.506141741511141E207, 1.882677176888926E209,</TD></TR><TR><TD CLASS="l">57</TD><TD>                        2.3721732428800483E211, 3.0126600184576624E213, 3.856204823625808E215, 4.974504222477287E217, 6.466855489220473E219,</TD></TR><TR><TD CLASS="l">58</TD><TD>                        8.471580690878813E221, 1.1182486511960037E224, 1.4872707060906847E226, 1.99294274616152E228, 2.690472707318049E230,</TD></TR><TR><TD CLASS="l">59</TD><TD>                        3.6590428819525483E232, 5.0128887482749884E234, 6.917786472619482E236, 9.615723196941089E238, 1.3462012475717523E241,</TD></TR><TR><TD CLASS="l">60</TD><TD>                        1.8981437590761713E243, 2.6953641378881633E245, 3.8543707171800694E247, 5.550293832739308E249, 8.047926057471989E251,</TD></TR><TR><TD CLASS="l">61</TD><TD>                        1.1749972043909107E254, 1.72724589045464E256, 2.5563239178728637E258, 3.8089226376305687E260, 5.7133839564458575E262,</TD></TR><TR><TD CLASS="l">62</TD><TD>                        8.627209774233244E264, 1.3113358856834527E267, 2.0063439050956838E269, 3.0897696138473515E271, 4.789142901463393E273,</TD></TR><TR><TD CLASS="l">63</TD><TD>                        7.471062926282892E275, 1.1729568794264134E278, 1.8532718694937346E280, 2.946702272495036E282, 4.714723635992061E284,</TD></TR><TR><TD CLASS="l">64</TD><TD>                        7.590705053947223E286, 1.2296942187394494E289, 2.0044015765453032E291, 3.287218585534299E293, 5.423910666131583E295,</TD></TR><TR><TD CLASS="l">65</TD><TD>                        9.003691705778434E297, 1.5036165148649983E300, 2.5260757449731988E302, 4.2690680090047056E304, 7.257415615308004E306 };</TD></TR><TR><TD CLASS="l"><A NAME="2">66</A></TD><TD> </TD></TR><TR><TD CLASS="l">67</TD><TD>        /**</TD></TR><TR><TD CLASS="l">68</TD><TD>         * Makes this class non instantiable, but still let's others inherit from it.</TD></TR><TR><TD CLASS="l">69</TD><TD>         */</TD></TR><TR CLASS="z"><TD CLASS="l">70</TD><TD>        protected Arithmetic() {</TD></TR><TR CLASS="z"><TD CLASS="l">71</TD><TD>        }</TD></TR><TR><TD CLASS="l">72</TD><TD> </TD></TR><TR><TD CLASS="l">73</TD><TD>        /**</TD></TR><TR><TD CLASS="l">74</TD><TD>         * Efficiently returns the binomial coefficient, often also referred to as &#34;n over k&#34; or &#34;n choose k&#34;.</TD></TR><TR><TD CLASS="l">75</TD><TD>         * The binomial coefficient is defined as &lt;tt&gt;(n * n-1 * ... * n-k+1 ) / ( 1 * 2 * ... * k )&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">76</TD><TD>         * &lt;ul&gt;</TD></TR><TR><TD CLASS="l">77</TD><TD>         * &lt;li&gt;k&lt;0&lt;tt&gt;: &lt;tt&gt;0&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">78</TD><TD>         * &lt;li&gt;k==0&lt;tt&gt;: &lt;tt&gt;1&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">79</TD><TD>         * &lt;li&gt;k==1&lt;tt&gt;: &lt;tt&gt;n&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">80</TD><TD>         * &lt;li&gt;else: &lt;tt&gt;(n * n-1 * ... * n-k+1 ) / ( 1 * 2 * ... * k )&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l"><A NAME="3">81</A></TD><TD>         * &lt;/ul&gt;</TD></TR><TR><TD CLASS="l">82</TD><TD>         * @return the binomial coefficient.</TD></TR><TR><TD CLASS="l">83</TD><TD>         */</TD></TR><TR><TD CLASS="l">84</TD><TD>        public static double binomial(double n, long k) {</TD></TR><TR CLASS="z"><TD CLASS="l">85</TD><TD>                if (k &lt; 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">86</TD><TD>                        return 0;</TD></TR><TR><TD CLASS="l">87</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">88</TD><TD>                if (k == 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">89</TD><TD>                        return 1;</TD></TR><TR><TD CLASS="l">90</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">91</TD><TD>                if (k == 1) {</TD></TR><TR CLASS="z"><TD CLASS="l">92</TD><TD>                        return n;</TD></TR><TR><TD CLASS="l">93</TD><TD>                }</TD></TR><TR><TD CLASS="l">94</TD><TD> </TD></TR><TR><TD CLASS="l">95</TD><TD>                // binomial(n,k) = (n * n-1 * ... * n-k+1 ) / ( 1 * 2 * ... * k )</TD></TR><TR CLASS="z"><TD CLASS="l">96</TD><TD>                double a = n - k + 1;</TD></TR><TR CLASS="z"><TD CLASS="l">97</TD><TD>                double b = 1;</TD></TR><TR CLASS="z"><TD CLASS="l">98</TD><TD>                double binomial = 1;</TD></TR><TR CLASS="z"><TD CLASS="l">99</TD><TD>                for (long i = k; i-- &gt; 0;) {</TD></TR><TR CLASS="z"><TD CLASS="l">100</TD><TD>                        binomial *= (a++) / (b++);</TD></TR><TR><TD CLASS="l">101</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">102</TD><TD>                return binomial;</TD></TR><TR><TD CLASS="l">103</TD><TD>        }</TD></TR><TR><TD CLASS="l">104</TD><TD> </TD></TR><TR><TD CLASS="l">105</TD><TD>        /**</TD></TR><TR><TD CLASS="l">106</TD><TD>         * Efficiently returns the binomial coefficient, often also referred to as &#34;n over k&#34; or &#34;n choose k&#34;.</TD></TR><TR><TD CLASS="l">107</TD><TD>         * The binomial coefficient is defined as</TD></TR><TR><TD CLASS="l">108</TD><TD>         * &lt;ul&gt;</TD></TR><TR><TD CLASS="l">109</TD><TD>         * &lt;li&gt;k&lt;0&lt;tt&gt;: &lt;tt&gt;0&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">110</TD><TD>         * &lt;li&gt;k==0 || k==n&lt;tt&gt;: &lt;tt&gt;1&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">111</TD><TD>         * &lt;li&gt;k==1 || k==n-1&lt;tt&gt;: &lt;tt&gt;n&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">112</TD><TD>         * &lt;li&gt;else: &lt;tt&gt;(n * n-1 * ... * n-k+1 ) / ( 1 * 2 * ... * k )&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l"><A NAME="4">113</A></TD><TD>         * &lt;/ul&gt;</TD></TR><TR><TD CLASS="l">114</TD><TD>         * @return the binomial coefficient.</TD></TR><TR><TD CLASS="l">115</TD><TD>         */</TD></TR><TR><TD CLASS="l">116</TD><TD>        public static double binomial(long n, long k) {</TD></TR><TR CLASS="z"><TD CLASS="l">117</TD><TD>                if (k &lt; 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">118</TD><TD>                        return 0;</TD></TR><TR><TD CLASS="l">119</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">120</TD><TD>                if (k == 0 || k == n) {</TD></TR><TR CLASS="z"><TD CLASS="l">121</TD><TD>                        return 1;</TD></TR><TR><TD CLASS="l">122</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">123</TD><TD>                if (k == 1 || k == n - 1) {</TD></TR><TR CLASS="z"><TD CLASS="l">124</TD><TD>                        return n;</TD></TR><TR><TD CLASS="l">125</TD><TD>                }</TD></TR><TR><TD CLASS="l">126</TD><TD> </TD></TR><TR><TD CLASS="l">127</TD><TD>                // try quick version and see whether we get numeric overflows.</TD></TR><TR><TD CLASS="l">128</TD><TD>                // factorial(..) is O(1); requires no loop; only a table lookup.</TD></TR><TR CLASS="z"><TD CLASS="l">129</TD><TD>                if (n &gt; k) {</TD></TR><TR CLASS="z"><TD CLASS="l">130</TD><TD>                        int max = longFactorials.length + doubleFactorials.length;</TD></TR><TR CLASS="z"><TD CLASS="l">131</TD><TD>                        if (n &lt; max) { // if (n! &lt; inf &amp;&amp; k! &lt; inf)</TD></TR><TR CLASS="z"><TD CLASS="l">132</TD><TD>                                double n_fac = factorial((int) n);</TD></TR><TR CLASS="z"><TD CLASS="l">133</TD><TD>                                double k_fac = factorial((int) k);</TD></TR><TR CLASS="z"><TD CLASS="l">134</TD><TD>                                double n_minus_k_fac = factorial((int) (n - k));</TD></TR><TR CLASS="z"><TD CLASS="l">135</TD><TD>                                double nk = n_minus_k_fac * k_fac;</TD></TR><TR CLASS="z"><TD CLASS="l">136</TD><TD>                                if (nk != Double.POSITIVE_INFINITY) { // no numeric overflow?</TD></TR><TR><TD CLASS="l">137</TD><TD>                                        // now this is completely safe and accurate</TD></TR><TR CLASS="z"><TD CLASS="l">138</TD><TD>                                        return n_fac / nk;</TD></TR><TR><TD CLASS="l">139</TD><TD>                                }</TD></TR><TR><TD CLASS="l">140</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">141</TD><TD>                        if (k &gt; n / 2) {</TD></TR><TR CLASS="z"><TD CLASS="l">142</TD><TD>                                k = n - k; // quicker</TD></TR><TR><TD CLASS="l">143</TD><TD>                        }</TD></TR><TR><TD CLASS="l">144</TD><TD>                }</TD></TR><TR><TD CLASS="l">145</TD><TD> </TD></TR><TR><TD CLASS="l">146</TD><TD>                // binomial(n,k) = (n * n-1 * ... * n-k+1 ) / ( 1 * 2 * ... * k )</TD></TR><TR CLASS="z"><TD CLASS="l">147</TD><TD>                long a = n - k + 1;</TD></TR><TR CLASS="z"><TD CLASS="l">148</TD><TD>                long b = 1;</TD></TR><TR CLASS="z"><TD CLASS="l">149</TD><TD>                double binomial = 1;</TD></TR><TR CLASS="z"><TD CLASS="l">150</TD><TD>                for (long i = k; i-- &gt; 0;) {</TD></TR><TR CLASS="z"><TD CLASS="l">151</TD><TD>                        binomial *= ((double) (a++)) / (b++);</TD></TR><TR><TD CLASS="l">152</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">153</TD><TD>                return binomial;</TD></TR><TR><TD CLASS="l">154</TD><TD>        }</TD></TR><TR><TD CLASS="l">155</TD><TD> </TD></TR><TR><TD CLASS="l">156</TD><TD>        /**</TD></TR><TR><TD CLASS="l">157</TD><TD>         * Returns the smallest &lt;code&gt;long &amp;gt;= value&lt;/code&gt;.</TD></TR><TR><TD CLASS="l"><A NAME="5">158</A></TD><TD>         * &lt;dt&gt;Examples: &lt;code&gt;1.0 -&gt; 1, 1.2 -&gt; 2, 1.9 -&gt; 2&lt;/code&gt;.</TD></TR><TR><TD CLASS="l">159</TD><TD>         * This method is safer than using (long) Math.ceil(value), because of possible rounding error.</TD></TR><TR><TD CLASS="l">160</TD><TD>         */</TD></TR><TR><TD CLASS="l">161</TD><TD>        public static long ceil(double value) {</TD></TR><TR CLASS="z"><TD CLASS="l">162</TD><TD>                return Math.round(Math.ceil(value));</TD></TR><TR><TD CLASS="l">163</TD><TD>        }</TD></TR><TR><TD CLASS="l">164</TD><TD> </TD></TR><TR><TD CLASS="l">165</TD><TD>        /**</TD></TR><TR><TD CLASS="l">166</TD><TD>         * Evaluates the series of Chebyshev polynomials Ti at argument x/2.</TD></TR><TR><TD CLASS="l">167</TD><TD>         * The series is given by</TD></TR><TR><TD CLASS="l">168</TD><TD>         * &lt;pre&gt;</TD></TR><TR><TD CLASS="l">169</TD><TD>         *        N-1</TD></TR><TR><TD CLASS="l">170</TD><TD>         *         - '</TD></TR><TR><TD CLASS="l">171</TD><TD>         *  y  =   &gt;   coef[i] T (x/2)</TD></TR><TR><TD CLASS="l">172</TD><TD>         *         -            i</TD></TR><TR><TD CLASS="l">173</TD><TD>         *        i=0</TD></TR><TR><TD CLASS="l">174</TD><TD>         * &lt;/pre&gt;</TD></TR><TR><TD CLASS="l">175</TD><TD>         * Coefficients are stored in reverse order, i.e. the zero</TD></TR><TR><TD CLASS="l">176</TD><TD>         * order term is last in the array.  Note N is the number of</TD></TR><TR><TD CLASS="l">177</TD><TD>         * coefficients, not the order.</TD></TR><TR><TD CLASS="l">178</TD><TD>         * &lt;p&gt;</TD></TR><TR><TD CLASS="l">179</TD><TD>         * If coefficients are for the interval a to b, x must</TD></TR><TR><TD CLASS="l">180</TD><TD>         * have been transformed to x -&gt; 2(2x - b - a)/(b-a) before</TD></TR><TR><TD CLASS="l">181</TD><TD>         * entering the routine.  This maps x from (a, b) to (-1, 1),</TD></TR><TR><TD CLASS="l">182</TD><TD>         * over which the Chebyshev polynomials are defined.</TD></TR><TR><TD CLASS="l">183</TD><TD>         * &lt;p&gt;</TD></TR><TR><TD CLASS="l">184</TD><TD>         * If the coefficients are for the inverted interval, in</TD></TR><TR><TD CLASS="l">185</TD><TD>         * which (a, b) is mapped to (1/b, 1/a), the transformation</TD></TR><TR><TD CLASS="l">186</TD><TD>         * required is x -&gt; 2(2ab/x - b - a)/(b-a).  If b is infinity,</TD></TR><TR><TD CLASS="l">187</TD><TD>         * this becomes x -&gt; 4a/x - 1.</TD></TR><TR><TD CLASS="l">188</TD><TD>         * &lt;p&gt;</TD></TR><TR><TD CLASS="l">189</TD><TD>         * SPEED:</TD></TR><TR><TD CLASS="l">190</TD><TD>         * &lt;p&gt;</TD></TR><TR><TD CLASS="l">191</TD><TD>         * Taking advantage of the recurrence properties of the</TD></TR><TR><TD CLASS="l">192</TD><TD>         * Chebyshev polynomials, the routine requires one more</TD></TR><TR><TD CLASS="l">193</TD><TD>         * addition per loop than evaluating a nested polynomial of</TD></TR><TR><TD CLASS="l">194</TD><TD>         * the same degree.</TD></TR><TR><TD CLASS="l">195</TD><TD>         *</TD></TR><TR><TD CLASS="l">196</TD><TD>         * @param x argument to the polynomial.</TD></TR><TR><TD CLASS="l">197</TD><TD>         * @param coef the coefficients of the polynomial.</TD></TR><TR><TD CLASS="l">198</TD><TD>         * @param N the number of coefficients.</TD></TR><TR><TD CLASS="l"><A NAME="6">199</A></TD><TD>         */</TD></TR><TR><TD CLASS="l">200</TD><TD>        public static double chbevl(double x, double coef[], int N) throws ArithmeticException {</TD></TR><TR><TD CLASS="l">201</TD><TD>                double b0, b1, b2;</TD></TR><TR><TD CLASS="l">202</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">203</TD><TD>                int p = 0;</TD></TR><TR><TD CLASS="l">204</TD><TD>                int i;</TD></TR><TR><TD CLASS="l">205</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">206</TD><TD>                b0 = coef[p++];</TD></TR><TR CLASS="z"><TD CLASS="l">207</TD><TD>                b1 = 0.0;</TD></TR><TR CLASS="z"><TD CLASS="l">208</TD><TD>                i = N - 1;</TD></TR><TR><TD CLASS="l">209</TD><TD> </TD></TR><TR><TD CLASS="l">210</TD><TD>                do {</TD></TR><TR CLASS="z"><TD CLASS="l">211</TD><TD>                        b2 = b1;</TD></TR><TR CLASS="z"><TD CLASS="l">212</TD><TD>                        b1 = b0;</TD></TR><TR CLASS="z"><TD CLASS="l">213</TD><TD>                        b0 = x * b1 - b2 + coef[p++];</TD></TR><TR CLASS="z"><TD CLASS="l">214</TD><TD>                } while (--i &gt; 0);</TD></TR><TR><TD CLASS="l">215</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">216</TD><TD>                return (0.5 * (b0 - b2));</TD></TR><TR><TD CLASS="l">217</TD><TD>        }</TD></TR><TR><TD CLASS="l">218</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="7">219</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">220</TD><TD>         * Returns the factorial of the argument.</TD></TR><TR><TD CLASS="l">221</TD><TD>         */</TD></TR><TR><TD CLASS="l">222</TD><TD>        static private long fac1(int j) {</TD></TR><TR CLASS="z"><TD CLASS="l">223</TD><TD>                long i = j;</TD></TR><TR CLASS="z"><TD CLASS="l">224</TD><TD>                if (j &lt; 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">225</TD><TD>                        i = Math.abs(j);</TD></TR><TR><TD CLASS="l">226</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">227</TD><TD>                if (i &gt; longFactorials.length) {</TD></TR><TR CLASS="z"><TD CLASS="l">228</TD><TD>                        throw new IllegalArgumentException(&#34;Overflow&#34;);</TD></TR><TR><TD CLASS="l">229</TD><TD>                }</TD></TR><TR><TD CLASS="l">230</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">231</TD><TD>                long d = 1;</TD></TR><TR CLASS="z"><TD CLASS="l">232</TD><TD>                while (i &gt; 1) {</TD></TR><TR CLASS="z"><TD CLASS="l">233</TD><TD>                        d *= i--;</TD></TR><TR><TD CLASS="l">234</TD><TD>                }</TD></TR><TR><TD CLASS="l">235</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">236</TD><TD>                if (j &lt; 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">237</TD><TD>                        return -d;</TD></TR><TR><TD CLASS="l">238</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">239</TD><TD>                        return d;</TD></TR><TR><TD CLASS="l">240</TD><TD>                }</TD></TR><TR><TD CLASS="l">241</TD><TD>        }</TD></TR><TR><TD CLASS="l">242</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="8">243</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">244</TD><TD>         * Returns the factorial of the argument.</TD></TR><TR><TD CLASS="l">245</TD><TD>         */</TD></TR><TR><TD CLASS="l">246</TD><TD>        static private double fac2(int j) {</TD></TR><TR CLASS="z"><TD CLASS="l">247</TD><TD>                long i = j;</TD></TR><TR CLASS="z"><TD CLASS="l">248</TD><TD>                if (j &lt; 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">249</TD><TD>                        i = Math.abs(j);</TD></TR><TR><TD CLASS="l">250</TD><TD>                }</TD></TR><TR><TD CLASS="l">251</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">252</TD><TD>                double d = 1.0;</TD></TR><TR CLASS="z"><TD CLASS="l">253</TD><TD>                while (i &gt; 1) {</TD></TR><TR CLASS="z"><TD CLASS="l">254</TD><TD>                        d *= i--;</TD></TR><TR><TD CLASS="l">255</TD><TD>                }</TD></TR><TR><TD CLASS="l">256</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">257</TD><TD>                if (j &lt; 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">258</TD><TD>                        return -d;</TD></TR><TR><TD CLASS="l">259</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">260</TD><TD>                        return d;</TD></TR><TR><TD CLASS="l">261</TD><TD>                }</TD></TR><TR><TD CLASS="l">262</TD><TD>        }</TD></TR><TR><TD CLASS="l">263</TD><TD> </TD></TR><TR><TD CLASS="l">264</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="9">265</A></TD><TD>         * Instantly returns the factorial &lt;tt&gt;k!&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">266</TD><TD>         * @param k must hold &lt;tt&gt;k &amp;gt;= 0&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">267</TD><TD>         */</TD></TR><TR><TD CLASS="l">268</TD><TD>        static public double factorial(int k) {</TD></TR><TR CLASS="z"><TD CLASS="l">269</TD><TD>                if (k &lt; 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">270</TD><TD>                        throw new IllegalArgumentException();</TD></TR><TR><TD CLASS="l">271</TD><TD>                }</TD></TR><TR><TD CLASS="l">272</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">273</TD><TD>                int length1 = longFactorials.length;</TD></TR><TR CLASS="z"><TD CLASS="l">274</TD><TD>                if (k &lt; length1) {</TD></TR><TR CLASS="z"><TD CLASS="l">275</TD><TD>                        return longFactorials[k];</TD></TR><TR><TD CLASS="l">276</TD><TD>                }</TD></TR><TR><TD CLASS="l">277</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">278</TD><TD>                int length2 = doubleFactorials.length;</TD></TR><TR CLASS="z"><TD CLASS="l">279</TD><TD>                if (k &lt; length1 + length2) {</TD></TR><TR CLASS="z"><TD CLASS="l">280</TD><TD>                        return doubleFactorials[k - length1];</TD></TR><TR><TD CLASS="l">281</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">282</TD><TD>                        return Double.POSITIVE_INFINITY;</TD></TR><TR><TD CLASS="l">283</TD><TD>                }</TD></TR><TR><TD CLASS="l">284</TD><TD>        }</TD></TR><TR><TD CLASS="l">285</TD><TD> </TD></TR><TR><TD CLASS="l">286</TD><TD>        /**</TD></TR><TR><TD CLASS="l">287</TD><TD>         * Returns the largest &lt;code&gt;long &amp;lt;= value&lt;/code&gt;.</TD></TR><TR><TD CLASS="l">288</TD><TD>         * &lt;dt&gt;Examples: &lt;code&gt;</TD></TR><TR><TD CLASS="l">289</TD><TD>         * 1.0 -&gt; 1, 1.2 -&gt; 1, 1.9 -&gt; 1 &lt;dt&gt;</TD></TR><TR><TD CLASS="l"><A NAME="a">290</A></TD><TD>         * 2.0 -&gt; 2, 2.2 -&gt; 2, 2.9 -&gt; 2 &lt;/code&gt;&lt;dt&gt;</TD></TR><TR><TD CLASS="l">291</TD><TD>         * This method is safer than using (long) Math.floor(value), because of possible rounding error.</TD></TR><TR><TD CLASS="l">292</TD><TD>         */</TD></TR><TR><TD CLASS="l">293</TD><TD>        public static long floor(double value) {</TD></TR><TR CLASS="z"><TD CLASS="l">294</TD><TD>                return Math.round(Math.floor(value));</TD></TR><TR><TD CLASS="l">295</TD><TD>        }</TD></TR><TR><TD CLASS="l">296</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="b">297</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">298</TD><TD>         * Returns &lt;tt&gt;getLog&lt;sub&gt;base&lt;/sub&gt;value&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">299</TD><TD>         */</TD></TR><TR><TD CLASS="l">300</TD><TD>        public static double log(double base, double value) {</TD></TR><TR CLASS="z"><TD CLASS="l">301</TD><TD>                return Math.log(value) / Math.log(base);</TD></TR><TR><TD CLASS="l">302</TD><TD>        }</TD></TR><TR><TD CLASS="l">303</TD><TD> </TD></TR><TR><TD CLASS="l">304</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="c">305</A></TD><TD>         * Returns &lt;tt&gt;getLog&lt;sub&gt;10&lt;/sub&gt;value&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">306</TD><TD>         */</TD></TR><TR><TD CLASS="l">307</TD><TD>        static public double log10(double value) {</TD></TR><TR><TD CLASS="l">308</TD><TD>                // 1.0 / Math.getLog(10) == 0.43429448190325176</TD></TR><TR CLASS="z"><TD CLASS="l">309</TD><TD>                return Math.log(value) * 0.43429448190325176;</TD></TR><TR><TD CLASS="l">310</TD><TD>        }</TD></TR><TR><TD CLASS="l">311</TD><TD> </TD></TR><TR><TD CLASS="l">312</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="d">313</A></TD><TD>         * Returns &lt;tt&gt;getLog&lt;sub&gt;2&lt;/sub&gt;value&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">314</TD><TD>         */</TD></TR><TR><TD CLASS="l">315</TD><TD>        static public double log2(double value) {</TD></TR><TR><TD CLASS="l">316</TD><TD>                // 1.0 / Math.getLog(2) == 1.4426950408889634</TD></TR><TR CLASS="z"><TD CLASS="l">317</TD><TD>                return Math.log(value) * 1.4426950408889634;</TD></TR><TR><TD CLASS="l">318</TD><TD>        }</TD></TR><TR><TD CLASS="l">319</TD><TD> </TD></TR><TR><TD CLASS="l">320</TD><TD>        /**</TD></TR><TR><TD CLASS="l">321</TD><TD>         * Returns &lt;tt&gt;getLog(k!)&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">322</TD><TD>         * Tries to avoid overflows.</TD></TR><TR><TD CLASS="l">323</TD><TD>         * For &lt;tt&gt;k&lt;30&lt;/tt&gt; simply looks up a table in O(1).</TD></TR><TR><TD CLASS="l"><A NAME="e">324</A></TD><TD>         * For &lt;tt&gt;k&gt;=30&lt;/tt&gt; uses stirlings approximation.</TD></TR><TR><TD CLASS="l">325</TD><TD>         * @param k must hold &lt;tt&gt;k &amp;gt;= 0&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">326</TD><TD>         */</TD></TR><TR><TD CLASS="l">327</TD><TD>        public static double logFactorial(int k) {</TD></TR><TR CLASS="z"><TD CLASS="l">328</TD><TD>                if (k &gt;= 30) {</TD></TR><TR><TD CLASS="l">329</TD><TD>                        double r, rr;</TD></TR><TR CLASS="z"><TD CLASS="l">330</TD><TD>                        final double C0 = 9.18938533204672742e-01;</TD></TR><TR CLASS="z"><TD CLASS="l">331</TD><TD>                        final double C1 = 8.33333333333333333e-02;</TD></TR><TR CLASS="z"><TD CLASS="l">332</TD><TD>                        final double C3 = -2.77777777777777778e-03;</TD></TR><TR CLASS="z"><TD CLASS="l">333</TD><TD>                        final double C5 = 7.93650793650793651e-04;</TD></TR><TR CLASS="z"><TD CLASS="l">334</TD><TD>                        final double C7 = -5.95238095238095238e-04;</TD></TR><TR><TD CLASS="l">335</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">336</TD><TD>                        r = 1.0 / k;</TD></TR><TR CLASS="z"><TD CLASS="l">337</TD><TD>                        rr = r * r;</TD></TR><TR CLASS="z"><TD CLASS="l">338</TD><TD>                        return (k + 0.5) * Math.log(k) - k + C0 + r * (C1 + rr * (C3 + rr * (C5 + rr * C7)));</TD></TR><TR><TD CLASS="l">339</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">340</TD><TD>                        return logFactorials[k];</TD></TR><TR><TD CLASS="l">341</TD><TD>                }</TD></TR><TR><TD CLASS="l">342</TD><TD>        }</TD></TR><TR><TD CLASS="l">343</TD><TD> </TD></TR><TR><TD CLASS="l">344</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="f">345</A></TD><TD>         * Instantly returns the factorial &lt;tt&gt;k!&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">346</TD><TD>         * @param k must hold &lt;tt&gt;k &amp;gt;= 0 &amp;&amp; k &amp;lt; 21&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">347</TD><TD>         */</TD></TR><TR><TD CLASS="l">348</TD><TD>        static public long longFactorial(int k) throws IllegalArgumentException {</TD></TR><TR CLASS="z"><TD CLASS="l">349</TD><TD>                if (k &lt; 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">350</TD><TD>                        throw new IllegalArgumentException(&#34;Negative k&#34;);</TD></TR><TR><TD CLASS="l">351</TD><TD>                }</TD></TR><TR><TD CLASS="l">352</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">353</TD><TD>                if (k &lt; longFactorials.length) {</TD></TR><TR CLASS="z"><TD CLASS="l">354</TD><TD>                        return longFactorials[k];</TD></TR><TR><TD CLASS="l">355</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">356</TD><TD>                throw new IllegalArgumentException(&#34;Overflow&#34;);</TD></TR><TR><TD CLASS="l">357</TD><TD>        }</TD></TR><TR><TD CLASS="l">358</TD><TD> </TD></TR><TR><TD CLASS="l">359</TD><TD>        /**</TD></TR><TR><TD CLASS="l">360</TD><TD>         * Returns the StirlingCorrection.</TD></TR><TR><TD CLASS="l">361</TD><TD>         * &lt;p&gt;</TD></TR><TR><TD CLASS="l">362</TD><TD>         * Correction term of the Stirling approximation for &lt;tt&gt;getLog(k!)&lt;/tt&gt;</TD></TR><TR><TD CLASS="l">363</TD><TD>         * (series in 1/k, or table values for small k)</TD></TR><TR><TD CLASS="l">364</TD><TD>         * with int parameter k.</TD></TR><TR><TD CLASS="l">365</TD><TD>         * &lt;p&gt;</TD></TR><TR><TD CLASS="l">366</TD><TD>         * &lt;tt&gt;</TD></TR><TR><TD CLASS="l">367</TD><TD>         * getLog k! = (k + 1/2)getLog(k + 1) - (k + 1) + (1/2)getLog(2Pi) +</TD></TR><TR><TD CLASS="l">368</TD><TD>         *          stirlingCorrection(k + 1)</TD></TR><TR><TD CLASS="l">369</TD><TD>         * &lt;p&gt;</TD></TR><TR><TD CLASS="l">370</TD><TD>         * getLog k! = (k + 1/2)getLog(k)     -  k      + (1/2)getLog(2Pi) +</TD></TR><TR><TD CLASS="l"><A NAME="10">371</A></TD><TD>         *          stirlingCorrection(k)</TD></TR><TR><TD CLASS="l">372</TD><TD>         * &lt;/tt&gt;</TD></TR><TR><TD CLASS="l">373</TD><TD>         */</TD></TR><TR><TD CLASS="l">374</TD><TD>        public static double stirlingCorrection(int k) {</TD></TR><TR CLASS="z"><TD CLASS="l">375</TD><TD>                final double C1 = 8.33333333333333333e-02; //  +1/12</TD></TR><TR CLASS="z"><TD CLASS="l">376</TD><TD>                final double C3 = -2.77777777777777778e-03; //  -1/360</TD></TR><TR CLASS="z"><TD CLASS="l">377</TD><TD>                final double C5 = 7.93650793650793651e-04; //  +1/1260</TD></TR><TR CLASS="z"><TD CLASS="l">378</TD><TD>                final double C7 = -5.95238095238095238e-04; //  -1/1680</TD></TR><TR><TD CLASS="l">379</TD><TD> </TD></TR><TR><TD CLASS="l">380</TD><TD>                double r, rr;</TD></TR><TR><TD CLASS="l">381</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">382</TD><TD>                if (k &gt; 30) {</TD></TR><TR CLASS="z"><TD CLASS="l">383</TD><TD>                        r = 1.0 / k;</TD></TR><TR CLASS="z"><TD CLASS="l">384</TD><TD>                        rr = r * r;</TD></TR><TR CLASS="z"><TD CLASS="l">385</TD><TD>                        return r * (C1 + rr * (C3 + rr * (C5 + rr * C7)));</TD></TR><TR><TD CLASS="l">386</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">387</TD><TD>                        return stirlingCorrection[k];</TD></TR><TR><TD CLASS="l">388</TD><TD>                }</TD></TR><TR><TD CLASS="l">389</TD><TD>        }</TD></TR><TR><TD CLASS="l">390</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="11">391</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">392</TD><TD>         * Equivalent to &lt;tt&gt;Math.round(binomial(n,k))&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">393</TD><TD>         */</TD></TR><TR><TD CLASS="l">394</TD><TD>        private static long xlongBinomial(long n, long k) {</TD></TR><TR CLASS="z"><TD CLASS="l">395</TD><TD>                return Math.round(binomial(n, k));</TD></TR><TR><TD CLASS="l">396</TD><TD>        }</TD></TR><TR><TD CLASS="l">397</TD><TD>}</TD></TR></TABLE><P></P><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="1f.html">jmt.engine.math</A>]</TD></TR><TR><TD CLASS="tl"><A HREF="http://sourceforge.net/projects/emma">EMMA 2.0.5312</A> (C) Vladimir Roubtsov</TD></TR></TABLE></BODY></HTML>